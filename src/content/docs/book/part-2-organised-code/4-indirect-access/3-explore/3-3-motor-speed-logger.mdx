---
title: Button-Controlled Motor Speed Logger  
description: "Explore pass-by-value, pass-by-reference, and pointer indirection in C++."  
sidebar:
  attrs:
    class: pi
  label: " - Motor Control"
---

Build a console program that:

1. Reads a potentiometer via the ADS7830 to determine an initial motor speed (0–100%).  
2. Lets the user press an “up” button (GPIO 11) or a “down” button (GPIO 13) three times to tweak that speed.  
3. Drives a DC motor (via L298N) at whatever speed you’ve computed.  
4. Records each raw ADC reading and its resulting speed in four separate `Log` structs (no arrays).

Your code should highlight three forms of indirection:

- **Pass-by-value**  
  ```cpp
  float raw_to_speed(int raw);
  ```

Converts a 0–255 reading into a 0.0–1.0 speed.

* **Pass-by-reference**

  ```cpp
  void adjust_speed(float &spd, bool increase);
  ```

  Increments or decrements the caller’s `spd` directly.

* **Pointer**

  ```cpp
  void log_entry(Log *entry, int raw, float spd);
  ```

  Fills a single `Log` instance via its pointer.

In `main()` you should:

* Initialize the Pi (`raspi_init()`), open the ADS7830 and motor, and configure pins 11/13 as inputs.
* Perform one “initial” read of the pot → convert → drive → log into `log0`.
* Then, **three times** (manually written out, no loops):

  * Prompt the user to press Enter,
  * Read pin 11/13 to decide up/down,
  * Call `adjust_speed`, update the motor,
  * Read the pot again and `log_entry` into `log1`, `log2`, `log3`.
* Finally, print the four `Log` values with `write_line()` and clean up (close ADC, motor, `raspi_cleanup()`).

---

**Example Console Session**

```txt
Turn pot & press Enter for initial speed  
[Enter]  
Raw=128 → Speed=0.502  
Running at 50%...

Press Enter for adjust #1  
[Enter]  
Button=Up → Speed=60%...

Press Enter for adjust #2  
[Enter]  
Button=Down → Speed=50%...

Press Enter for adjust #3  
[Enter]  
Button=Up → Speed=60%...

Log:  
Raw0=128 | 0.502  
Raw1=130 | 0.602  
Raw2=131 | 0.502  
Raw3=132 | 0.602  
```
