---
title: Loop Giving Change
sidebar:
  label: " - Loop Giving Change"
banner: 
  content: This is an optional tour - use it to extend your understanding.
---
import { Accordion, AccordionItem } from 'accessible-astro-components'


To conclude the change calculator we need to make this so that the user has the option to calculate another change value. The logic for this is shown in the following flow chart.

![Flowchart showing a block within a do while that is checking if the user wants to run again.](./images/change-calc-2-loop.png)

1. Add a new `again` variable, write out a prompt, and read in the new value at the end of the current code.
2. Add in a `do...while` loop that will repeat while `again` is not equal "N" or "n".

    :::tip
    While you might be thinking the condition for this loop needs to be "repeat while again does not equal 'N' **or** 'n'", in code you would actually need to use `again != "N" && again != "n"`.
    :::

    Go ahead and try implementing this. Make sure the `do while` loop, captures the code that reads the values from the users, as well as the code that outputs the change values.

    <Accordion>
      <AccordionItem header="Looping when asked">

      ```c++ {21-24,95-98}
      #include "splashkit.h"

      const int NUM_COIN_TYPES = 6;

      const int TWO_DOLLARS = 200;
      const int ONE_DOLLAR = 100;
      const int FIFTY_CENTS = 50;
      const int TWENTY_CENTS = 20;
      const int TEN_CENTS = 10;
      const int FIVE_CENTS = 5;

      int main()
      {
          string line;
          int cost_of_item;
          int amount_paid;
          int change_value;
          int to_give;
          int coin_value;
          string coin_text;
          string again;

          do
          {
              write("Cost of item in cents: ");
              line = read_line();
              while (!is_integer(line))
              {
                  write_line("Please enter a whole number.");
                  write("Cost of item in cents: ");
                  line = read_line();
              }

              cost_of_item = to_integer(line);

              write("Payment in cents: ");
              line = read_line();
              while (!is_integer(line))
              {
                  write_line("Please enter a whole number.");
                  write("Payment in cents: ");
                  line = read_line();
              }

              amount_paid = to_integer(line);

              change_value = amount_paid - cost_of_item;

              write_line("Change to give " + to_string(change_value));

              for(int i = 0; i < NUM_COIN_TYPES; i++)
              {
                  switch (i)
                  {
                      case 0:
                          coin_value = TWO_DOLLARS;
                          coin_text = "$2, ";
                          break;
                      case 1:
                          coin_value = ONE_DOLLAR;
                          coin_text = "$1, ";
                          break;
                      case 2:
                          coin_value = FIFTY_CENTS;
                          coin_text = "50c, ";
                          break;
                      case 3:
                          coin_value = TWENTY_CENTS;
                          coin_text = "20c, ";
                          break;
                      case 4:
                          coin_value = TEN_CENTS;
                          coin_text = "10c, ";
                          break;
                      case 5:
                          coin_value = FIVE_CENTS;
                          coin_text = "5c";
                          break;
                      default:
                          coin_value = 1;
                          coin_text = "ERROR";
                          break;
                  }

                  // Calculate the number of coins to give using the coin_value.
                  to_give = change_value / coin_value;

                  // Update the amount of change remaining
                  change_value = change_value - to_give * coin_value;

                  // Output the number of coins with the coin text
                  write(to_string(to_give) + " x " + coin_text);
              }

              write_line();
              write("Run again: ");
              again = read_line();
          } while (again != "N" && again != "n");

      }
      ```
      </AccordionItem>
    </Accordion>

    Compile, run, and test. Make sure that you can loop multiple times, and exit when you want. Test the program, and see if you can spot any issues.

    :::tip
    Make sure that you nest the existing code within the loop as a [compound statement](/book/part-1-instructions/3-control-flow/5-reference/02-0-compound-statement). Once you code the loop you can select the existing code in Visual Studio Code and press *tab* to indent it all one level further. You can also right-click and select "Format Document" to help with code layout.
    :::

3. To complete the program, we can need to check if the user has paid enough. If they have not paid enough, then we should output a message and see if they want to calculate change again.

    Have a go at this yourself. There are several ways you can achieve this.

    <Accordion>
      <AccordionItem header="Final code">

      In this solution we use a `continue;` statement to jump to the condition of the `do ... while` when there is insufficient funds.

      ```c++ {49-55}
      #include "splashkit.h"

      const int NUM_COIN_TYPES = 6;

      const int TWO_DOLLARS = 200;
      const int ONE_DOLLAR = 100;
      const int FIFTY_CENTS = 50;
      const int TWENTY_CENTS = 20;
      const int TEN_CENTS = 10;
      const int FIVE_CENTS = 5;

      int main()
      {
          string line;
          int cost_of_item;
          int amount_paid;
          int change_value;
          int to_give;
          int coin_value;
          string coin_text;
          string again;

          do
          {
              write("Cost of item in cents: ");
              line = read_line();
              while (!is_integer(line))
              {
                  write_line("Please enter a whole number.");
                  write("Cost of item in cents: ");
                  line = read_line();
              }

              cost_of_item = to_integer(line);

              write("Payment in cents: ");
              line = read_line();
              while (!is_integer(line))
              {
                  write_line("Please enter a whole number.");
                  write("Payment in cents: ");
                  line = read_line();
              }

              amount_paid = to_integer(line);

              change_value = amount_paid - cost_of_item;

              if (change_value < 0)
              {
                  write_line("Not enough money was paid.");
                  write("Run again: ");
                  again = read_line();
                  continue;
              }

              write_line("Change to give " + to_string(change_value));

              for(int i = 0; i < NUM_COIN_TYPES; i++)
              {
                  switch (i)
                  {
                      case 0:
                          coin_value = TWO_DOLLARS;
                          coin_text = "$2, ";
                          break;
                      case 1:
                          coin_value = ONE_DOLLAR;
                          coin_text = "$1, ";
                          break;
                      case 2:
                          coin_value = FIFTY_CENTS;
                          coin_text = "50c, ";
                          break;
                      case 3:
                          coin_value = TWENTY_CENTS;
                          coin_text = "20c, ";
                          break;
                      case 4:
                          coin_value = TEN_CENTS;
                          coin_text = "10c, ";
                          break;
                      case 5:
                          coin_value = FIVE_CENTS;
                          coin_text = "5c";
                          break;
                      default:
                          coin_value = 1;
                          coin_text = "ERROR";
                          break;
                  }

                  // Calculate the number of coins to give using the coin_value.
                  to_give = change_value / coin_value;

                  // Update the amount of change remaining
                  change_value = change_value - to_give * coin_value;

                  // Output the number of coins with the coin text
                  write(to_string(to_give) + " x " + coin_text);
              }

              write_line();
              write("Run again: ");
              again = read_line();
          } while (again != "N" && again != "n");

      }
      ```

      </AccordionItem>
    </Accordion>
